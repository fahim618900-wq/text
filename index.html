<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Live Code IDE</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- CodeMirror -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.65.14/lib/codemirror.min.css">
<script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.14/lib/codemirror.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.14/mode/javascript/javascript.js"></script>
<script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.14/mode/htmlmixed/htmlmixed.js"></script>
<script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.14/mode/css/css.js"></script>
<script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.14/mode/python/python.js"></script>

<style>
:root{
    --bg:#ffffff;
    --text:#000000;
    --header:#f5f5f5;
    --border:#dcdcdc;
}
body.dark{
    --bg:#0d0d0d;
    --text:#ffffff;
    --header:#1a1a1a;
    --border:#333333;
}

body{
    margin:0;
    background:var(--bg);
    color:var(--text);
    font-family:Arial,sans-serif;
    height:100vh;
    display:flex;
    flex-direction:column;
}

/* Header */
header{
    height:50px;
    background:var(--header);
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:0 10px;
    border-bottom:1px solid var(--border);
}

.header-left, .header-right{
    display:flex;
    align-items:center;
    gap:15px;
}

header svg{
    width:26px;
    height:26px;
    fill:var(--text);
    cursor:pointer;
}

header span{
    margin-left:5px;
    font-size:14px;
    cursor:pointer;
}

/* Editor */
#editor{
    height:50vh;
}

/* Preview */
#iframeOutput{
    width:100%;
    height:50vh;
    border:none;
}
</style>
</head>

<body>

<header>
    <div class="header-left">
        <!-- Full Screen -->
        <svg onclick="openFullScreen()" viewBox="0 0 24 24">
            <path d="M4 4h6V2H2v8h2V4m14 0v6h2V2h-8v2h6m0 14h-6v2h8v-8h-2v6M4 14H2v8h8v-2H4v-6z"/>
        </svg><span onclick="openFullScreen()">Full Screen</span>

        <!-- Download -->
        <svg onclick="downloadCode()" viewBox="0 0 24 24">
            <path d="M5 20h14v-2H5m7-14v8l3-3 1.41 1.41L12 18l-4.41-4.59L9 11l3 3V4h2z"/>
        </svg><span onclick="downloadCode()">Download</span>
    </div>

    <div class="header-right">
        <!-- Theme -->
        <svg onclick="toggleTheme()" viewBox="0 0 24 24">
            <path d="M12,3A9,9 0 0,0 3,12A9,9 0 0,0 12,21A9,9 0 0,0 12,3Z" />
        </svg>
    </div>
</header>

<!-- Editor -->
<textarea id="code"></textarea>

<!-- Preview -->
<iframe id="iframeOutput"></iframe>

<script>
// THEME
if(localStorage.getItem("theme")==="dark") document.body.classList.add("dark");
function toggleTheme(){
    document.body.classList.toggle("dark");
    localStorage.setItem("theme", document.body.classList.contains("dark")?"dark":"light");
}

// CodeMirror setup
const editor = CodeMirror.fromTextArea(document.getElementById("code"), {
    mode: "htmlmixed",
    lineNumbers: true,
    theme: "default",
    tabSize:2,
    viewportMargin: Infinity
});

// Load saved code
editor.setValue(localStorage.getItem("savedCode")||"");

// Auto-run and save
editor.on("change", ()=>{
    const code = editor.getValue();
    localStorage.setItem("savedCode", code);
    document.getElementById("iframeOutput").srcdoc = code;
});

// Download
function downloadCode(){
    const code = editor.getValue();
    const blob = new Blob([code], {type:"text/plain"});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "code.html";
    a.click();
}

// Full Screen
function openFullScreen(){
    localStorage.setItem("fullScreenCode", editor.getValue());
    window.location.href = "full_screen.html";
}
</script>

</body>
</html>
